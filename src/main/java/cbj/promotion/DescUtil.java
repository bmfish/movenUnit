
package cbj.promotion;

import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.DESKeySpec;
import java.security.SecureRandom;

public class DescUtil {
  private static final String PASSWORD_CRYPT_KEY = "Jeff_Key";

  private final static String DES = "DES";

  /** 
   * 加密 
   * @param src 数据源 
   * @param key 密钥，长度必须是8的倍数 
   * @return  返回加密后的数据 
   * @throws Exception 
   */

  public static byte[]  encrypt(byte[] src, byte[] key) throws Exception {
    //DES算法要求有一个可信任的随机数源 
    SecureRandom sr = new SecureRandom();
    // 从原始密匙数据创建DESKeySpec对象 
    DESKeySpec dks = new DESKeySpec(key);

    // 创建一个密匙工厂，然后用它把DESKeySpec转换成 
    // 一个SecretKey对象 
    SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(DES);
    SecretKey securekey = keyFactory.generateSecret(dks);

    // Cipher对象实际完成加密操作 

    Cipher cipher = Cipher.getInstance(DES);
    // 用密匙初始化Cipher对象 
    cipher.init(Cipher.ENCRYPT_MODE, securekey, sr);
    // 现在，获取数据并加密 
    // 正式执行加密操作 
    return cipher.doFinal(src);
  }

  /** 
   * 解密 
   * @param src 数据源 
   * @param key 密钥，长度必须是8的倍数 
   * @return   返回解密后的原始数据 
   * @throws Exception 
   */

  public static byte[] decrypt(byte[] src, byte[] key) throws Exception {
    // DES算法要求有一个可信任的随机数源 
    SecureRandom sr = new SecureRandom();
    // 从原始密匙数据创建一个DESKeySpec对象 
    DESKeySpec dks = new DESKeySpec(key);
    // 创建一个密匙工厂，然后用它把DESKeySpec对象转换成 

    // 一个SecretKey对象 
    SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(DES);
    SecretKey securekey = keyFactory.generateSecret(dks);
    // Cipher对象实际完成解密操作 
    Cipher cipher = Cipher.getInstance(DES);
    // 用密匙初始化Cipher对象 
    cipher.init(Cipher.DECRYPT_MODE, securekey, sr);
    // 现在，获取数据并解密 
    // 正式执行解密操作 
    return cipher.doFinal(src);
  }

  /** 
   * 密码解密 
   * @param data 
   * @return 
   * @throws Exception 
   */

  public final static String decrypt(String data) {
    try {
      return new String(decrypt(hex2byte(data.getBytes()),
      PASSWORD_CRYPT_KEY.getBytes()));
    } catch (Exception e) {
    }
    return null;
  }

  /** 
   * 密码加密 
   * @param password 
   * @return 
   * @throws Exception 
   */
  public final static String encrypt(String password) {
    try {
      return byte2hex(encrypt(password.getBytes(), PASSWORD_CRYPT_KEY.getBytes()));
    } catch (Exception e) {
    }
    return null;
  }

  /** 
   * 二行制转字符串 
   * @param b 
   * @return 
   */
  public static String byte2hex(byte[] b) {
    String hs = "";
    String stmp = "";
    for (int n = 0; n < b.length; n++) {
      stmp = (Integer.toHexString(b[n] & 0XFF));
      if (stmp.length() == 1){
        hs = hs + "0" + stmp;
      }else{
        hs = hs + stmp;
      }
    }
    return hs.toUpperCase();
  }

  public static byte[] hex2byte(byte[] b) {
    if ((b.length % 2) != 0)
      throw new IllegalArgumentException("长度不是偶数");
    byte[] b2 = new byte[b.length / 2];
    for (int n = 0; n < b.length; n += 2) {
      String item = new String(b, n, 2);
      b2[n / 2] = (byte) Integer.parseInt(item, 16);
    }
    return b2;
  }
  
  public static void main(String args[]) throws Exception{
	  System.out.println(decrypt("A4CD7734290413F5E2B74806988CCC402E65D90F1EC16931A227BB80BB7EAEACDD6FD57AFD6EA69759D976EE42E1B0BC103365920CF3F300B6A8814EF349D7B297D7B23B2E010EC98B0C28D791E05C77BF584842B2ADCB7954B9365A50B0D56E74596DC951A910E792DEB7717E6AAAB4C707D7E584847B6135300F9FBA29A6D4CE443BF8B7B94234C5F274009E98621691F8D853B9428DC7F2BBC3DEA2D0B878E2ED137A1BC30682DF44DA614E395871A9583A6317315C43503108EF6968680E5A9FE48E8C96BBF69B85C999E478879D624DEE334887821F0DB7E4121AA6DB2252AA7DDB1C1829D05247E6213070A92612803730AEFD09875F1D3DAD89D39EAFDD8C9DF95A6BF7BE7DAE038A9428FEED4D85FC6B73FF4E676A28F6A5017F9DD51427A98BF008084DD8DD3794DCBB20A2AD8FC4B32EB216E0EF8937B072CDC707A83199420877DF49A0CF5E6F17C959B7506E887BE2AACB3D89B49E7C854B942309B9FD7A49992D1C4CCBC1678899E354BF026FA85947DA0C8EA5FC5D91528F95844B68AB2B4273D52BB36F867FC820CB4078E8020663EE48E23344E62BD36A26FC2EFEC42B5F006033DD7341869B81F6FAF27966D8A25414FE04747E99F503B1F0637CBA229235EF18267D553B026A926546337F5F6B23E5E5FA0DAA7C624F3C4C607A979E7B093405DCCF2F9219473B681D15B5CCCF0F7E8FADB7FED17A1926D4EBB697BD5F41651E915995EA3389B923930242769D51503617443C9BB1E6CDF1E8D0CBF8A8B12A15FED9E991D25E99E1FB801073B95CBAE2BB5030F05E32D0D4BDB3ECF1320F7C0D99AF9E94D07398CFE30F835FA16E0FE2D2740472080162ECCA7CE40E3ECB1E71CC9AFCA621C2F07CB6A3A58AD358FF8A5B9A4A81C6CDF1774DFD3CF8BB375EB7337958417DAAD87B8D45CC298D58B1F144EB2DDB295279783A3AD616123FF3ADA35731CA22B16C34EB43BADBB4CD2354FF6EEB5B6C31BC70AFA126CFE68527C351599B1753C3EE4B6D2407A7D5FA68669BBEB9E7AC52F84AF51562AA834D90CD3D215FC36B6518D29ABB8CC1450CD8D972285B582296AF60CCD32FA4186986E2D5CEAFC3F6783A688AF057577A518FAC2AE60C60747FF88B83F03E50921ABD582D44092957A3E09A7E169A2722E0B62AE7B2E3C025E82E860A21824A2852D376D5265F9D3BE3FE13C9AA81021D1D4DDA834E75433A2BFD995518AA7CB3BE170863CD1795BA7068E34CB4144EAD6496AD0D48D1BB461727F8A185A01704E4055FC6CF38A2FC9535C10C129654C095D2A51AB742816735C44912AC628747FFF7414E25F9281BA992430E9D01EF0A0DE47901C58F73F5052D76B3B53BC5950BAD76D52C2908FF3A1A36030266FD01A3FC5E3C21E88BBB52CF2EE59E9CF31D444DE651441DCCE91F053DA6C78BA70292A1BC149977E875C667F57471F39C4ECE2AD3A8AAB9157C81171715B0BEB9D11B6A8F1E8988BD42F82DA65EDC3216431E4CA624A63D87EC2C7E127E7CB9E6F961BE283CD75AB14712548DA788B936E74572562EF0C48A204B755335D196C0DE37708EE5D58E25CCEB100B1404343F25FD19D9FD8E9B90B97D036A2FE0E1A66E6BF8EF1655F8603096FE562616CC613F36ED3533310E48075C7F04268E1CBDD4B7BC1BC9F673401092A5BD6C04DF2EB6B001ADB6E5AF36B103DFD7D87DB507E957EDD8D600F947C6892E9190765B971FBEA912C6EA90CCB1B8FA944BB68097DF743DACF696939D468FBCE9F4B29CD38145E72636854D1D0733404CAC28557F6826146B7F883125EB3CB44DD7A47F074E0104B5AA7A9D3714B85CCC0A417B1854DAD57B30BA3755707510FC5F0465DA45F488ED693532832372D034BDAB56880C9F29DC9E3E075443BD74D9008141DE876DB904E935F4F5C1A46B4AF0C8701049BA142244BF6B975817C514E0A952C956D72FF3A768819AEF7CC4EED8454B70F36D21C614E1A29202832D8D124693F9F79419829664F5BB6B9441F9525E7148E412B5AE729394559D171BA4FD938451CDCC325A5AEBBAD85A195B4C354CE949BF802010B50AF8580BC8EED0CEAF0FD02DD1D4521D9BC3BA6F37ECC3D05D8E90A065A2FD62DA4B26FD0D66DD28EC49D47B93BAC1EBCD446AC90632982959C836CCEDF27B7A886A542F53AB06AB580184EA5A4DD9AE618866C90784E629AE84840A7BB8535C40E369E781FD3498C8C6F7DA8FE9E8008DCE562265F397EBDFA70CAB571098798DE521AA5ADC88DE70B5705E293158D5438299CC0A9E698860512EE844B5F7A56E730B509CDB942C0C9835BE6A7CA2C69715BBDC90ADDD5F47D6B17DD3B459A7D1FF2DDE6C7B3FA2F134853E197FE4762A162EEE434A26E9D657E4E4419B3C89261D1FCC798094DD00D8473C0E47EC911B26E560D1133FA2F134853E197FE4762A162EEE434A26E9D657E4E4419B5AC7731686C76ADB47C97468467054E990CFAF8E3EB63BC36C934C843052A8CC7834B6EDF9945127194034D8F260B4B0B4A3350AD204E53A5900C159FD28CEC3EA825DA8C951D99A85EAA7D9ACDB7805BCD4F465251D6F5C7FECC44070ABDD28CE5B4EA8951312147697A9382745D858A99E56E823B8B33015945B933374F4000EC533EA8135FE03B56C6232E2311C69ED805359A04C1250B1A230C7F438BEB2C274A498E94B60124F85D36A8D853AA36F4094AA5259663D9C205DD2E2F4AEBA6FFD21C8753EB66C56EA75B795F062CC37818B14D36B154155FE8E07C4D5FF33BFC24D3C6190130F49947CCD33CA51EAD024B0967A7F66C2AE98AF0E8B302359E804F8ADE6823538367253743310005574786B9C38CC50E23D2D9BC7AA13C9B2B76FF02AF7AD087411ED4E4332561DCB6195017F510807536DFB20A3A3D9421CA0DE7AB439EBB06AA83EF6D731E59F9065C7C314FC3DF6016BFFE623438744627B8A8002CD2603C6FD1B135AE323D92B497C6395A355D9548DBA1B08E6945F9548FEB7C1D407A49E1737BECDE2F190D6AA4EC44580932360C37B99AD78CBC34821F66A419B2F2BE06C76CC3CDFFB7875B1B7D572E189B3069702BB350D110280"));
  }
  
}
